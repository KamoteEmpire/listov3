<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/themes/listo-theme.min.css" />
  <link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />
  <link rel="stylesheet" href="css/themes/jquery.mobile.structure-1.4.5.min.css" />
  <link rel="stylesheet" href="css/jquery-ui.min.css" />
  <link rel="stylesheet" href="css/jquery-ui.structure.min.css" />
  
  <script src="js/jquery.min.js"></script> 
  <script src="js/jquery.mobile-1.4.5.min.js"></script>
  <script src="js/jquery-ui.min.js"></script>
  <script>
	$(document).ready(function(){
			$('#btnLogin').click(function(){
			
			if (navigator.onLine) {
				console.log("user is online");

				var formLogin = $("#frmLogin");
				$.mobile.loading("show");
				$.getJSON("http://iligtas.ph/listo/mobile/login.php?callback=?", formLogin.serialize(),function(data)
				{
					if (data.verified == "yes")
					{
					localStorage.setItem("datausername", data.username);
					localStorage.setItem("datapassword", data.password);
					localStorage.setItem("dataregion", data.region);
					localStorage.setItem("dataprovince", data.province);
					localStorage.setItem("datacity", data.city);
					localStorage.setItem("localPreMonitorCounter", 0);
					localStorage.setItem("localPreMonitorPercentage", 0);
					localStorage.setItem("preMonitor-a-1", 0);
					localStorage.setItem("preMonitor-a-2", 0);
					
					
					localStorage.setItem("preMonitor-b-1", 0);
					localStorage.setItem("preMonitor-b-2", 0);
					localStorage.setItem("preMonitor-b-3", 0);
					localStorage.setItem("preMonitor-b-4", 0);
					localStorage.setItem("preMonitor-b-5", 0);
					localStorage.setItem("preMonitor-b-6", 0);
					localStorage.setItem("preMonitor-b-7", 0);
					localStorage.setItem("preMonitor-b-8", 0);
					localStorage.setItem("preMonitor-b-9", 0);
					localStorage.setItem("preMonitor-b-10", 0);
					localStorage.setItem("preMonitor-b-11", 0);
					localStorage.setItem("preMonitor-b-12", 0);
					localStorage.setItem("preMonitor-b-13", 0);
					localStorage.setItem("preMonitor-b-14", 0);
					localStorage.setItem("preMonitor-b-15", 0);
					localStorage.setItem("preMonitor-b-16", 0);
					
					localStorage.setItem("preMonitor-c-1", 0);
					localStorage.setItem("preMonitor-c-2", 0);
					localStorage.setItem("preMonitor-c-3", 0);
					localStorage.setItem("preMonitor-c-4", 0);
					localStorage.setItem("preMonitor-c-5", 0);
					localStorage.setItem("preMonitor-c-6", 0);
					
					
					localStorage.setItem("preMonitor-d-1", 0);
					localStorage.setItem("preMonitor-d-2", 0);
					localStorage.setItem("preMonitor-d-3", 0);
					localStorage.setItem("preMonitor-d-4", 0);
					localStorage.setItem("preMonitor-d-5", 0);
					localStorage.setItem("preMonitor-d-6", 0);
					localStorage.setItem("preMonitor-d-7", 0);
					localStorage.setItem("preMonitor-d-8", 0);
					localStorage.setItem("preMonitor-d-9", 0);
					localStorage.setItem("preMonitor-d-10", 0);
					localStorage.setItem("preMonitor-d-11", 0);
					
					
					$("#popuptextWelcome").html("<strong>Welcome to Listo "+data.city+"</strong>");	
					$( "#popupAfterWelcome" ).popup();
					$( "#popupAfterWelcome" ).popup( "open", { 
					positionTo: "window",
					transition: "slidedown" });
					$.mobile.loading("hide");
					location.href="home.html";
					}
					else{
					$("#popuptext").html("<strong>Please check your username or password.</strong>");	
					$( "#popupAfter" ).popup();
					$( "#popupAfter" ).popup( "open", { 
					positionTo: "window",
					transition: "slidedown" });
					$.mobile.loading("hide");
					$( "#txtUsername" ).effect( "shake" );
					$( "#txtPassword" ).effect( "shake" );
					}
				}).fail(function(data){
					$("#popuptext").html("<strong>Error, Please contact administrator</strong>");	
					$( "#popupAfter" ).popup();
					$( "#popupAfter" ).popup( "open", { 
					positionTo: "window",
					transition: "pop" });
					$.mobile.loading("hide");
				});
				
		}
		else{
					$("#popuptext").html("<strong>Error, Please check your connection</strong>");	
					$( "#popupAfter" ).popup();
					$( "#popupAfter" ).popup( "open", { 
					positionTo: "window",
					transition: "pop" });
					$.mobile.loading("hide");
		}
			});
	});
  </script>

</head>
<body>
	<div data-role="page" >
		<!--<div data-role="header">
			<h1>Login Page</h1>
		</div>-->
		<div role="main" class="ui-content">
			<img src="images/listo-icon.png" style="width:40%;margin-left:auto;margin-right:auto;display:block">
			<br/>
			<form id="frmLogin">
			<input id="txtUsername" name="txtUsername" type="text" placeholder="Enter Username" />
			<input id="txtPassword" name="txtPassword" type="password" placeholder="Enter Password" />
			</form>
			<button class="ui-btn" id="btnLogin">SUBMIT</button>
		
			<a href="#" ><p style="text-align: center; ">Forgot Password?</p></a>
			
		</div>
		<!--<div data-role="footer" data-position="fixed">
		<div data-role="navbar" >
			<ul>
				<li><button data-icon="check" id="btnLogin">SUBMIT</button></li>
			</ul>
		</div>
		</div>-->
		<div data-role="popup" id="popupAfter" data-theme="d"  style="width:100%;margin-left: auto; margin-right:auto;">
			<div data-role="header">
				<h1>Error</h1>
			</div>
			<p id="popuptext" style="text-align: center;"></p>
		</div>
		<div data-role="popup" id="popupAfterWelcome" data-theme="d"  style="width:100%;margin-left: auto; margin-right:auto;">
			<div data-role="header">
				<h1>Welcome</h1>
			</div>
			<p id="popuptextWelcome" style="text-align: center;"></p>
		</div>
	</div>
</body>
</html>